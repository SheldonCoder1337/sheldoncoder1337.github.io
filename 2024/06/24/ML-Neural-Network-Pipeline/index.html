<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ML-Neural Network Pipeline | 安居乐业</title>
  <meta name="keywords" content=" ML ">
  <meta name="description" content="ML-Neural Network Pipeline | 安居乐业">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="汇编指令练习 对sub执行反汇编，查看sub x5, x6, x7这条汇编指令对应的机器指令的编码，并对照RISC-V的specification解析该条指令的编码 现知道某条RISC-V的机器指令在内存中的值为b3 05 95 00, 从左往右从低地址到高地址，单位为字节，请将其翻译为对应的汇编指令。  Reference The RISC-V Instruction Set Manual ht">
<meta property="og:type" content="article">
<meta property="og:title" content="RV-practice">
<meta property="og:url" content="https://sheldoncoder1337.github.io/2024/07/12/RV-Arithmetic-practice/index.html">
<meta property="og:site_name" content="安居乐业">
<meta property="og:description" content="汇编指令练习 对sub执行反汇编，查看sub x5, x6, x7这条汇编指令对应的机器指令的编码，并对照RISC-V的specification解析该条指令的编码 现知道某条RISC-V的机器指令在内存中的值为b3 05 95 00, 从左往右从低地址到高地址，单位为字节，请将其翻译为对应的汇编指令。  Reference The RISC-V Instruction Set Manual ht">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-07-12T14:30:05.000Z">
<meta property="article:modified_time" content="2024-07-12T07:28:20.311Z">
<meta property="article:author" content="Sheldon &amp; Vila">
<meta property="article:tag" content="RV">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/zenbum.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Sheldon &amp; Vila</span>
</div>

<div class="icon">
    
        
    
        
            <a title="github"
               href="https://github.com/sheldoncoder1337"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <a title="email"
               href="mailto:862314702@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="ALL">ALL
            
                <small>(27)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="Algo">
            
            Algo
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="BD">
            
            BD
            <small>(0)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="DA">
            
            DA
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="DB">
            
            DB
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JAVA">
            
            JAVA
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Math">
            
            Math
            <small>(4)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="ML">
            
            ML
            <small>(6)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="RISCV">
            
            RISCV
            <small>(7)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="SE">
            
            SE
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="tools">
            
            tools
            <small>(2)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="27">
<input type="hidden" id="yelog_site_word_count" value="22.4k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">ALL</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>朱朱</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>algorithm, find-the-shortest-path</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>assemble language</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Big Data</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Data structure & Algorithm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Database System</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Distribution</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hexo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ML</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Object Oriented</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pattern recognition</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RV</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Software Engineering</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="ALL RISCV "
           href="/2024/07/12/RV-Arithmetic-practice/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-practice">RV-practice</span>
            <span class="post-date" title="2024-07-12 22:30:05">2024/07/12</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/07/12/RV-Arithmetic-Ins/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-Arithmetic-Instructions">RV-Arithmetic-Instructions</span>
            <span class="post-date" title="2024-07-12 10:30:05">2024/07/12</span>
        </a>
        
        
        <a  class="ALL DB "
           href="/2024/07/08/DB-Cache/"
           data-tag="Distribution,Big Data"
           data-author="sheldon" >
            <span class="post-title" title="DB-Cache">DB-Cache</span>
            <span class="post-date" title="2024-07-08 17:47:40">2024/07/08</span>
        </a>
        
        
        <a  class="ALL SE "
           href="/2024/07/08/SE-OOD/"
           data-tag="Software Engineering,Object Oriented"
           data-author="sheldon" >
            <span class="post-title" title="SE-OOD">SE-OOD</span>
            <span class="post-date" title="2024-07-08 17:28:44">2024/07/08</span>
        </a>
        
        
        <a  class="ALL DB "
           href="/2024/07/08/DB-NormalForms/"
           data-tag="Database System"
           data-author="sheldon" >
            <span class="post-title" title="DB-NormalForms">DB-NormalForms</span>
            <span class="post-date" title="2024-07-08 17:25:00">2024/07/08</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/07/06/ML-Clustering-Introduction/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Clustering-Introduction">ML-Clustering-Introduction</span>
            <span class="post-date" title="2024-07-06 11:29:27">2024/07/06</span>
        </a>
        
        
        <a  class="ALL JAVA "
           href="/2024/07/04/JAVA-GaussDB/"
           data-tag="朱朱"
           data-author="Vila" >
            <span class="post-title" title="GaussDB">GaussDB</span>
            <span class="post-date" title="2024-07-04 17:43:25">2024/07/04</span>
        </a>
        
        
        <a  class="ALL JAVA "
           href="/2024/07/03/JAVA-Note/"
           data-tag="朱朱"
           data-author="Vila" >
            <span class="post-title" title="JavaNoteBook">JavaNoteBook</span>
            <span class="post-date" title="2024-07-03 23:15:28">2024/07/03</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/06/30/RV-Makefile/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-Makefile">RV-Makefile</span>
            <span class="post-date" title="2024-06-30 23:43:05">2024/06/30</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/06/30/RV-Assemble-language/"
           data-tag="assemble language"
           data-author="" >
            <span class="post-title" title="RV-Assemble Language">RV-Assemble Language</span>
            <span class="post-date" title="2024-06-30 16:30:31">2024/06/30</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/06/29/RV-%E7%BC%96%E8%AF%91%E4%B8%8E%E9%93%BE%E6%8E%A5/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-编译与链接">RV-编译与链接</span>
            <span class="post-date" title="2024-06-29 17:34:12">2024/06/29</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/06/29/RV-pre/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-RISC-V preliminaries">RV-RISC-V preliminaries</span>
            <span class="post-date" title="2024-06-29 17:17:41">2024/06/29</span>
        </a>
        
        
        <a  class="ALL tools "
           href="/2024/06/29/Tools-WSL%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="WSL/git命令速查">WSL/git命令速查</span>
            <span class="post-date" title="2024-06-29 15:54:20">2024/06/29</span>
        </a>
        
        
        <a  class="ALL RISCV "
           href="/2024/06/25/RV-Intro/"
           data-tag="RV"
           data-author="" >
            <span class="post-title" title="RV-RISC-V Introduction">RV-RISC-V Introduction</span>
            <span class="post-date" title="2024-06-25 12:32:12">2024/06/25</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/06/24/ML-Neural-Network-Pipeline/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Neural Network Pipeline">ML-Neural Network Pipeline</span>
            <span class="post-date" title="2024-06-24 16:53:43">2024/06/24</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/06/06/ML-Autoencoder/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Autoencoder">ML-Autoencoder</span>
            <span class="post-date" title="2024-06-06 22:10:03">2024/06/06</span>
        </a>
        
        
        <a  class="ALL Math "
           href="/2024/05/04/PR-SVD/"
           data-tag="pattern recognition"
           data-author="" >
            <span class="post-title" title="PR-SVD">PR-SVD</span>
            <span class="post-date" title="2024-05-04 12:05:25">2024/05/04</span>
        </a>
        
        
        <a  class="ALL Math "
           href="/2024/05/04/PR-ch04-NLC/"
           data-tag="pattern recognition"
           data-author="" >
            <span class="post-title" title="PR-ch04-NLC">PR-ch04-NLC</span>
            <span class="post-date" title="2024-05-04 10:53:37">2024/05/04</span>
        </a>
        
        
        <a  class="ALL Math "
           href="/2024/05/04/PR-ch03-LC/"
           data-tag="pattern recognition"
           data-author="" >
            <span class="post-title" title="PR-ch03-LC">PR-ch03-LC</span>
            <span class="post-date" title="2024-05-04 10:53:25">2024/05/04</span>
        </a>
        
        
        <a  class="ALL Math "
           href="/2024/04/30/PR-ch02-Bayes/"
           data-tag="pattern recognition"
           data-author="" >
            <span class="post-title" title="PR-ch02-Bayes">PR-ch02-Bayes</span>
            <span class="post-date" title="2024-04-30 20:45:31">2024/04/30</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/04/24/ML-Clustering-Kmeans/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Clustering-Kmeans">ML-Clustering-Kmeans</span>
            <span class="post-date" title="2024-04-24 17:36:07">2024/04/24</span>
        </a>
        
        
        <a  class="ALL Algo "
           href="/2024/04/17/Shortest-Path-%E2%85%A1/"
           data-tag="algorithm, find-the-shortest-path"
           data-author="" >
            <span class="post-title" title="Shortest Path Ⅱ">Shortest Path Ⅱ</span>
            <span class="post-date" title="2024-04-17 19:00:00">2024/04/17</span>
        </a>
        
        
        <a  class="ALL Algo "
           href="/2024/04/17/Shortest-Path-%E2%85%A0/"
           data-tag="algorithm, find-the-shortest-path"
           data-author="" >
            <span class="post-title" title="Shortest Path Ⅰ">Shortest Path Ⅰ</span>
            <span class="post-date" title="2024-04-17 11:42:38">2024/04/17</span>
        </a>
        
        
        <a  class="ALL tools "
           href="/2024/04/16/Tools-hexo-hand-book/"
           data-tag="hexo"
           data-author="" >
            <span class="post-title" title="hexo hand book">hexo hand book</span>
            <span class="post-date" title="2024-04-16 23:06:14">2024/04/16</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/04/10/ML-Clustering-Practice/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Clustering-Practice">ML-Clustering-Practice</span>
            <span class="post-date" title="2024-04-10 22:22:21">2024/04/10</span>
        </a>
        
        
        <a  class="ALL ML "
           href="/2024/04/01/ML-Introduction/"
           data-tag="ML"
           data-author="sheldon" >
            <span class="post-title" title="ML-Introduction">ML-Introduction</span>
            <span class="post-date" title="2024-04-01 13:25:25">2024/04/01</span>
        </a>
        
        
        <a  class="ALL DA "
           href="/2024/01/01/DA-01-Array/"
           data-tag="Data structure &amp; Algorithm"
           data-author="" >
            <span class="post-title" title="DA-Array">DA-Array</span>
            <span class="post-date" title="2024-01-01 13:50:00">2024/01/01</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-ML-Neural-Network-Pipeline" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">ML-Neural Network Pipeline</h1>
    
    <div class="article-meta">
        
        
        <span class="author"><a>sheldon</a></span>
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="ML">ML</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">ML</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2024-07-06 23:58:14'>2024-06-24 16:53</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:1.1k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-1-Prepare-Data"><span class="toc-text">Step 1: Prepare Data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-2-Define-Neural-Nets"><span class="toc-text">Step 2: Define Neural Nets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-3-Define-loss-function-and-the-optimizer"><span class="toc-text">Step 3: Define loss function and the optimizer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-4-Train-the-neural-nets"><span class="toc-text">Step 4: Train the neural nets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Try-Different-Network-Structure"><span class="toc-text">Try Different Network Structure</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <pre><code class="python"># load necessary libraries
import torch
import torchvision
from torch import nn
from torch.utils.data import DataLoader
from torchvision import datasets
from torchvision.transforms import ToTensor, Lambda, Compose
import matplotlib.pyplot as plt
from time import time

# print(torch.__version__)
# print(torchvision.__version__)
</code></pre>
<p>The Dataset used in this tutorial</p>
<p><code>Fashion-MNIST</code> is a dataset of Zalando’s article images consisting of of 60,000 training examples and 10,000 test examples. Each example comprises a 28×28 grayscale image and an associated label from one of 10 classes.</p>
<pre><code class="python"># download FashionMNIST dataset
training_data = datasets.FashionMNIST(
    root=&quot;data&quot;,
    train=True,
    download=True,
    transform=ToTensor() # ToTensor() transforms the data to tensor type and rescale [0,255] uint8 to [0,1] float
)

# Download test data from open datasets.
test_data = datasets.FashionMNIST(
    root=&quot;data&quot;,
    train=False,
    download=True,
    transform=ToTensor()
)

# print(dir(training_data)) # print all attribute of an object
# print(training_data.data[0,:]) # print info of the first picture
# plt.imshow(training_data.data[0,:], cmap=plt.get_cmap(&#39;gray&#39;)) # visualize the first picture
</code></pre>
<h2 id="Step-1-Prepare-Data"><a href="#Step-1-Prepare-Data" class="headerlink" title="Step 1: Prepare Data"></a>Step 1: Prepare Data</h2><pre><code class="python">batch_size = 128
# print(training_data.data[0,:])

# Create data loaders.
train_dataloader = DataLoader(training_data, batch_size=batch_size, shuffle=True)
test_dataloader = DataLoader(test_data, batch_size=batch_size)

# check the first batch of the dataset
for X, y in test_dataloader:
    print(&quot;Shape of X [N, C, H, W]: &quot;, X.shape, X.dtype) # 
    print(&quot;Shape of y: &quot;, y.shape, y.dtype)
    break
    
# N: number of data instance in a batch
# C: channel, number of colors in a pixel here
# [H, W]: Height and width of a picture
</code></pre>
<pre><code class="txt">Shape of X [N, C, H, W]:  torch.Size([128, 1, 28, 28]) torch.float32
Shape of y:  torch.Size([128]) torch.int64
</code></pre>
<pre><code class="python"># visualize sample images
nsamples=10
classes_names = [&#39;T-shirt/top&#39;, &#39;Trouser&#39;, &#39;Pullover&#39;, &#39;Dress&#39;, &#39;Coat&#39;, &#39;Sandal&#39;,&#39;Shirt&#39;, &#39;Sneaker&#39;, &#39;Bag&#39;, &#39;Ankle boot&#39;]
imgs, labels = next(iter(train_dataloader))

fig=plt.figure(figsize=(20,5),facecolor=&#39;w&#39;)
for i in range(nsamples):
    ax = plt.subplot(1,nsamples, i+1)
#     print(imgs[i, 0, :, :])
    plt.imshow(imgs[i, 0, :, :], cmap=plt.get_cmap(&#39;gray&#39;))
    ax.set_title(&quot;&#123;&#125;&quot;.format(classes_names[labels[i]]), fontsize=15)
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)

plt.show()
</code></pre>


<h2 id="Step-2-Define-Neural-Nets"><a href="#Step-2-Define-Neural-Nets" class="headerlink" title="Step 2: Define Neural Nets"></a>Step 2: Define Neural Nets</h2><pre><code class="python">class MyModel(nn.Module):
    def __init__(self):
        super(MyModel, self).__init__()
        self.linear_relu_stack = nn.Sequential(
            # This is how your layers are defined and stacked sequentially
            nn.Flatten(), # given an image of size 28x28, it will be flattened to a vector of size 784 # reshape the input to 1D (a very long vector)
            nn.Linear(784, 128), # 784×128 parameters
            nn.ReLU(), # if negative, it becomes 0
            nn.Dropout(0.2),
            nn.Linear(128, 10), # 128×10 output 128 layers and 10 labels
            nn.Sigmoid() 
        )

    def forward(self, x):
        y = self.linear_relu_stack(x)
        return y

model = MyModel()
print(model)
</code></pre>
<pre><code class="txt">MyModel(
  (linear_relu_stack): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=784, out_features=128, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=128, out_features=10, bias=True)
    (5): Sigmoid()
  )
)
</code></pre>
<h2 id="Step-3-Define-loss-function-and-the-optimizer"><a href="#Step-3-Define-loss-function-and-the-optimizer" class="headerlink" title="Step 3: Define loss function and the optimizer"></a>Step 3: Define loss function and the optimizer</h2><pre><code class="python"># define a loss function you want to optimize 
loss_fn = nn.CrossEntropyLoss()

# define an optimizer
optimizer = torch.optim.Adam(model.parameters()) # Adam: A Method for Stochastic Optimization
</code></pre>
<h2 id="Step-4-Train-the-neural-nets"><a href="#Step-4-Train-the-neural-nets" class="headerlink" title="Step 4: Train the neural nets"></a>Step 4: Train the neural nets</h2><pre><code class="python"># epochs: how many times we would like to traverse the whole dataset
epochs=5

for i in range(epochs): # iterate over epochs
    tic = time()
    model.train()
    train_loss=0
    for j, (X, y) in enumerate(train_dataloader): # iterate over batches 
        # Compute prediction error
        pred = model(X)
        loss = loss_fn(pred, y)
        train_loss += loss.item()
        # Backpropagation
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        # print learning process every 100 batches
        if j % 100 == 0:
            loss, current = loss.item(), j * len(X)
            print(f&quot;epoch &#123;i&#125; batch &#123;j&#125; loss: &#123;loss/batch_size:&gt;7f&#125;&quot;)
    
    train_time = time() - tic
    
    # print test results after every epochs    
    with torch.no_grad():
        model.eval()
        test_loss=0
        hit=0
        for (X, y) in test_dataloader:
            pred = model(X)
            test_loss += loss_fn(pred, y).item()
            hit += (pred.argmax(1) == y).sum().item()
        print(f&quot;epoch &#123;i&#125; training time: &#123;train_time:&gt;3f&#125;s, train loss: &#123;train_loss/len(train_dataloader.dataset):&gt;7f&#125; test loss: &#123;test_loss/len(test_dataloader.dataset):&gt;7f&#125; accuracy: &#123;hit/len(test_dataloader.dataset) :&gt;7f&#125;&quot;)    
</code></pre>
<pre><code class="txt">epoch 0 batch 0 loss: 0.017987
epoch 0 batch 100 loss: 0.013263
epoch 0 batch 200 loss: 0.013020
epoch 0 batch 300 loss: 0.013196
epoch 0 batch 400 loss: 0.012888
epoch 0 training time: 3.524010s, train loss: 0.013305 test loss: 0.012916 accuracy: 0.587600
epoch 1 batch 0 loss: 0.012708
epoch 1 batch 100 loss: 0.012738
epoch 1 batch 200 loss: 0.012615
epoch 1 batch 300 loss: 0.012646
epoch 1 batch 400 loss: 0.012460
epoch 1 training time: 3.451036s, train loss: 0.012682 test loss: 0.012763 accuracy: 0.617100
epoch 2 batch 0 loss: 0.012583
epoch 2 batch 100 loss: 0.012776
epoch 2 batch 200 loss: 0.012628
epoch 2 batch 300 loss: 0.012702
epoch 2 batch 400 loss: 0.012469
epoch 2 training time: 3.448095s, train loss: 0.012553 test loss: 0.012686 accuracy: 0.642400
epoch 3 batch 0 loss: 0.012615
epoch 3 batch 100 loss: 0.012434
epoch 3 batch 200 loss: 0.012553
epoch 3 batch 300 loss: 0.012463
epoch 3 batch 400 loss: 0.012621
epoch 3 training time: 3.463367s, train loss: 0.012486 test loss: 0.012625 accuracy: 0.650900
epoch 4 batch 0 loss: 0.012159
...
epoch 4 batch 200 loss: 0.012609
epoch 4 batch 300 loss: 0.012223
epoch 4 batch 400 loss: 0.012312
epoch 4 training time: 3.480916s, train loss: 0.012431 test loss: 0.012592 accuracy: 0.666100
</code></pre>
<h2 id="Try-Different-Network-Structure"><a href="#Try-Different-Network-Structure" class="headerlink" title="Try Different Network Structure"></a>Try Different Network Structure</h2><ul>
<li>linear model with NO hidden layer, No dropout, No non-linearity activation</li>
</ul>
<pre><code class="python">class ShallowModel(nn.Module):
    def __init__(self):
        super(ShallowModel, self).__init__()
        self.linear_stack = nn.Sequential(
            nn.Flatten(),
            nn.Linear(28*28, 10),
            nn.Sigmoid()
        )

    def forward(self, x):
        y = self.linear_stack(x)
        return y
    
model = ShallowModel()
print(model)

# define a loss function you want to optimize 
loss_fn = nn.CrossEntropyLoss()

# define an optimizer
optimizer = torch.optim.Adam(model.parameters()) 
</code></pre>
<ul>
<li>two hidden layers with 128 neurons and 32 neurons<ul>
<li>Activation Relu</li>
<li>Dropout 0.2</li>
</ul>
</li>
</ul>
<pre><code class="python">class DeepModel(nn.Module):
    def __init__(self):
        super(DeepModel, self).__init__()
        self.linear_relu_stack = nn.Sequential(
            nn.Flatten(),
            nn.Linear(28*28, 128),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(128, 32),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(32, 10),
            nn.Sigmoid()
        )

    def forward(self, x):
        y = self.linear_relu_stack(x)
        return y

model = DeepModel()
print(model)
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> Please cite the source for reprints, feel free to verify the sources cited in the article, and feel free to point out any errors or lack of clarity of expression. You can comment in the comments section below or email to 862314702@qq.com 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 862314702@qq.com </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>ML-Neural Network Pipeline</p>
    <p><span class="copy-title">字数:</span><span class="post-count">1.1k</span></p>
    <p><span class="copy-title">本文作者:</span><a  title="Sheldon &amp; Vila">Sheldon &amp; Vila</a></p>
    <p><span class="copy-title">发布时间:</span>2024-06-24, 16:53:43</p>
    <p><span class="copy-title">最后更新:</span>2024-07-06, 23:58:14</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2024/06/24/ML-Neural-Network-Pipeline/" title="ML-Neural Network Pipeline">https://sheldoncoder1337.github.io/2024/06/24/ML-Neural-Network-Pipeline/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">&#34;署名-非商用-相同方式共享 4.0&#34;</a> 转载请保留原文链接及作者。
    </p>
</div>



    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '4f33aa329333316d7b3e',
            clientSecret: 'b042f64bfd07ed32f8bb8c729eb6c2973e48f58d',
            repo: 'sheldoncoder1337.github.io',
            owner: 'sheldoncoder1337',
            admin: ['sheldoncoder1337'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2024 sheldoncoder1337
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
        /* 渲染*/
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }
        if (window.mermaid){
            window.mermaid = null
        }
        $.getScript("//cdn.jsdelivr.net/npm/mermaid@8.4.2/dist/mermaid.min.js", function () {
            var mermaidOptions = JSON.parse(HTMLDecode("{&#34;theme&#34;:&#34;default&#34;,&#34;startOnLoad&#34;:true,&#34;flowchart&#34;:{&#34;useMaxWidth&#34;:false,&#34;htmlLabels&#34;:true}}"))
            if (window.mermaid) {
                mermaid.initialize(mermaidOptions)
                mermaid.contentLoaded()
            }
        })
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>






</html>
